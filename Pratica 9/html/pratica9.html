<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
<!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      -->
<title>Laborat&oacute;rio de Sistemas Din&acirc;icos</title>
<meta name="generator" content="MATLAB 24.1">
<link rel="schema.DC" href="http://purl.org/dc/elements/1.1/">
<meta name="DC.date" content="2024-08-24">
<meta name="DC.source" content="pratica9.m">
<style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; }

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }
span.typesection { color:#A0522D }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style>
</head>
<body>
<div class="content">
<h1>Laborat&oacute;rio de Sistemas Din&acirc;icos</h1>
<!--introduction-->
<p>Pr&aacute;tica 08 29/07/2024 Autores: Victor Hugo Daia Lorenzato e Whilker Henrique Santos Silva</p>
<!--/introduction-->
<h2>Contents</h2>
<div>
<ul>
<li>
<a href="#1">Limpar workspace</a>
</li>
<li>
<a href="#2">Ex01 - importa&ccedil;&atilde;o dados</a>
</li>
<li>
<a href="#3">Ex01 - C&aacute;lculo do Ganho</a>
</li>
<li>
<a href="#4">Ex01 - M&eacute;todo da integrais</a>
</li>
<li>
<a href="#5">Ex01 - M&eacute;todo de 1 constante de tempo</a>
</li>
<li>
<a href="#6">Ex01 - M&eacute;todo de 4 constantes de tempo</a>
</li>
<li>
<a href="#7">Ex01 - M&eacute;todo de Ziegler-Nichols</a>
</li>
<li>
<a href="#8">Ex01 - M&eacute;todo de Smith</a>
</li>
<li>
<a href="#9">Ex01 - M&eacute;todo de Haglund</a>
</li>
<li>
<a href="#10">Ex01 - M&eacute;todo de Sundaresan e Krishnaswami</a>
</li>
<li>
<a href="#11">Ex01 - M&eacute;todo da inclina&ccedil;&atilde;o inicial;</a>
</li>
<li>
<a href="#12">Ex01 - Compara&ccedil;&atilde;o dos erros m&eacute;dios quadraticos</a>
</li>
</ul>
</div>
<h2 id="1">Limpar workspace</h2>
<pre class="codeinput">close <span class="string">all</span>;
clear;
clc;
</pre>
<h2 id="2">Ex01 - importa&ccedil;&atilde;o dados</h2>
<pre class="codeinput">data = load(<span class="string">'dadosordem1.txt'</span>);

tempo = data(:,1);
entrada = data(:,2);
saida = data(:,3);

plot(tempo, entrada);
title(<span class="string">"Entrada do sistema"</span>);
xlabel(<span class="string">"Tempo(s)"</span>);
ylabel(<span class="string">"Tens&atilde;o (Volts)"</span>);


figure();
plot(tempo, saida);
title(<span class="string">"Sa&iacute;da do sistema"</span>);
xlabel(<span class="string">"Tempo(s)"</span>);
ylabel(<span class="string">"Temperatura (&deg;C)"</span>);
grid(<span class="string">"on"</span>);
</pre>
<img vspace="5" hspace="5" src="pratica9_01.png" alt=""> <img vspace="5" hspace="5" src="pratica9_02.png" alt=""> <h2 id="3">Ex01 - C&aacute;lculo do Ganho</h2>
<pre class="codeinput">du = entrada(end) - 0;
dy = 8 - 2;

k = dy/du;

fprintf(<span class="string">"Ganho dc do sistema &eacute; igual a %.2f &deg;C/V \n"</span>, k);
</pre>
<pre class="codeoutput">Ganho dc do sistema &eacute; igual a 3.00 &deg;C/V 
</pre>
<h2 id="4">Ex01 - M&eacute;todo da integrais</h2>
<pre class="codeinput">entrada_normalizada = entrada / 2;
saida_normalizada = (saida - 2) / 6;

Iu = cumtrapz(tempo, entrada_normalizada);
Iy = cumtrapz(tempo, saida_normalizada);

A1 = Iu(end) - Iy(end);

i = 1;
<span class="keyword">while</span>(saida_normalizada(i) &lt; 0.632)
    i = i + 1;
<span class="keyword">end</span>

tau_a= Iy(i) * exp(1);
theta_a = A1 - tau_a;

fprintf(<span class="string">"K = %.2f &deg;C/V \n"</span>, k);
fprintf(<span class="string">"theta = %f segundos \n"</span>, theta_a);
fprintf(<span class="string">"tau = %f segundos \n"</span>, tau_a);

s = tf(<span class="string">'s'</span>);
Hs_a = (k*exp(- theta_a * s)) / (tau_a*s + 1);
y_a = (2*step(Hs_a, tempo)) + 2;

figure();
hold(<span class="string">"on"</span>);
plot(tempo, saida);
plot(tempo, y_a);
title(<span class="string">"Resposta do sistema - M&eacute;todo da integrais"</span>);
xlabel(<span class="string">"Tempo(s)"</span>);
ylabel(<span class="string">"Temperatura (&deg;C)"</span>);
grid(<span class="string">"on"</span>);

erro_a = 0;
<span class="keyword">for</span> i = 1: 1: 1000

    erro_a = erro_a + (saida(i) - y_a(i))^2;

<span class="keyword">end</span>

erro_a = erro_a/1000;
</pre>
<pre class="codeoutput">K = 3.00 &deg;C/V 
theta = 6.822068 segundos 
tau = 8.055515 segundos 
</pre>
<img vspace="5" hspace="5" src="pratica9_03.png" alt=""> <h2 id="5">Ex01 - M&eacute;todo de 1 constante de tempo</h2>
<pre class="codeinput">theta_b = 5;
tau_b = 15 - theta_b;


Hs_b = (k*exp(- theta_b * s)) / (tau_b*s + 1);
y_b = (2*step(Hs_b, tempo)) + 2;

fprintf(<span class="string">"K = %.2f &deg;C/V \n"</span>, k);
fprintf(<span class="string">"theta = %f segundos \n"</span>, theta_b);
fprintf(<span class="string">"tau = %f segundos \n"</span>, tau_b);

figure();
hold(<span class="string">"on"</span>);
plot(tempo, saida);
plot(tempo, y_b);
title(<span class="string">"Resposta do sistema - M&eacute;todo de 1 constante de tempo"</span>);
xlabel(<span class="string">"Tempo(s)"</span>);
ylabel(<span class="string">"Temperatura (&deg;C)"</span>);
grid(<span class="string">"on"</span>);

erro_b = 0;
<span class="keyword">for</span> i = 1: 1: 1000

    erro_b = erro_b + (saida(i) - y_b(i))^2;

<span class="keyword">end</span>

erro_b = erro_b/1000;
</pre>
<pre class="codeoutput">K = 3.00 &deg;C/V 
theta = 5.000000 segundos 
tau = 10.000000 segundos 
</pre>
<img vspace="5" hspace="5" src="pratica9_04.png" alt=""> <h2 id="6">Ex01 - M&eacute;todo de 4 constantes de tempo</h2>
<pre class="codeinput">theta_c = 5;
tau_c = 43/4 - theta_c;


Hs_c = (k*exp(- theta_c * s)) / (tau_c*s + 1);
y_c = (2*step(Hs_c, tempo)) + 2;

fprintf(<span class="string">"K = %.2f &deg;C/V \n"</span>, k);
fprintf(<span class="string">"theta = %f segundos \n"</span>, theta_c);
fprintf(<span class="string">"tau = %f segundos \n"</span>, tau_c);

figure();
hold(<span class="string">"on"</span>);
plot(tempo, saida);
plot(tempo, y_c);
title(<span class="string">"Resposta do sistema - M&eacute;todo de 4 constantes de tempo"</span>);
xlabel(<span class="string">"Tempo(s)"</span>);
ylabel(<span class="string">"Temperatura (&deg;C)"</span>);
grid(<span class="string">"on"</span>);

erro_c = 0;
<span class="keyword">for</span> i = 1: 1: 1000

    erro_c = erro_c + (saida(i) - y_c(i))^2;

<span class="keyword">end</span>

erro_c = erro_c/1000;
</pre>
<pre class="codeoutput">K = 3.00 &deg;C/V 
theta = 5.000000 segundos 
tau = 5.750000 segundos 
</pre>
<img vspace="5" hspace="5" src="pratica9_05.png" alt=""> <h2 id="7">Ex01 - M&eacute;todo de Ziegler-Nichols</h2>
<pre class="codeinput">theta_d = 5;
tau_d = 16.5 - theta_d;

Hs_d = (k*exp(- theta_d * s)) / (tau_d*s + 1);
y_d = (2*step(Hs_d, tempo)) + 2;

fprintf(<span class="string">"K = %.2f &deg;C/V \n"</span>, k);
fprintf(<span class="string">"theta = %f segundos \n"</span>, theta_d);
fprintf(<span class="string">"tau = %f segundos \n"</span>, tau_d);

figure();
hold(<span class="string">"on"</span>);
plot(tempo, saida);
plot(tempo, y_d);
title(<span class="string">"Resposta do sistema - M&eacute;todo de Ziegler-Nichols"</span>);
xlabel(<span class="string">"Tempo(s)"</span>);
ylabel(<span class="string">"Temperatura (&deg;C)"</span>);
grid(<span class="string">"on"</span>);

erro_d = 0;
<span class="keyword">for</span> i = 1: 1: 1000

    erro_d = erro_d + (saida(i) - y_d(i))^2;

<span class="keyword">end</span>

erro_d = erro_d/1000;
</pre>
<pre class="codeoutput">K = 3.00 &deg;C/V 
theta = 5.000000 segundos 
tau = 11.500000 segundos 
</pre>
<img vspace="5" hspace="5" src="pratica9_06.png" alt=""> <h2 id="8">Ex01 - M&eacute;todo de Smith</h2>
<pre class="codeinput">t1 = 6.15;
t2 = 15;

tau_e = 1.5 * (t2-t1);
theta_e = t2 - tau_e;

Hs_e = (k*exp(- theta_e * s)) / (tau_e*s + 1);
y_e = (2*step(Hs_e, tempo)) + 2;

fprintf(<span class="string">"K = %.2f &deg;C/V \n"</span>, k);
fprintf(<span class="string">"theta = %f segundos \n"</span>, theta_e);
fprintf(<span class="string">"tau = %f segundos \n"</span>, tau_e);

figure();
hold(<span class="string">"on"</span>);
plot(tempo, saida);
plot(tempo, y_e);
title(<span class="string">"Resposta do sistema - M&eacute;todo de Smith"</span>);
xlabel(<span class="string">"Tempo(s)"</span>);
ylabel(<span class="string">"Temperatura (&deg;C)"</span>);
grid(<span class="string">"on"</span>);

erro_e = 0;
<span class="keyword">for</span> i = 1: 1: 1000

    erro_e = erro_e + (saida(i) - y_e(i))^2;

<span class="keyword">end</span>

erro_e = erro_e/1000;
</pre>
<pre class="codeoutput">K = 3.00 &deg;C/V 
theta = 1.725000 segundos 
tau = 13.275000 segundos 
</pre>
<img vspace="5" hspace="5" src="pratica9_07.png" alt=""> <h2 id="9">Ex01 - M&eacute;todo de Haglund</h2>
<pre class="codeinput">theta_f = 5;
tau_f = 13.5 - theta_f;

Hs_f = (k*exp(- theta_f * s)) / (tau_f*s + 1);
y_f = (2*step(Hs_f, tempo)) + 2;

fprintf(<span class="string">"K = %.2f &deg;C/V \n"</span>, k);
fprintf(<span class="string">"theta = %f segundos \n"</span>, theta_f);
fprintf(<span class="string">"tau = %f segundos \n"</span>, tau_f);

figure();
hold(<span class="string">"on"</span>);
plot(tempo, saida);
plot(tempo, y_f);
title(<span class="string">"Resposta do sistema - M&eacute;todo de Haglund"</span>);
xlabel(<span class="string">"Tempo(s)"</span>);
ylabel(<span class="string">"Temperatura (&deg;C)"</span>);
grid(<span class="string">"on"</span>);

erro_f = 0;
<span class="keyword">for</span> i = 1: 1: 1000

    erro_f = erro_f + (saida(i) - y_f(i))^2;

<span class="keyword">end</span>

erro_f = erro_f/1000;
</pre>
<pre class="codeoutput">K = 3.00 &deg;C/V 
theta = 5.000000 segundos 
tau = 8.500000 segundos 
</pre>
<img vspace="5" hspace="5" src="pratica9_08.png" alt=""> <h2 id="10">Ex01 - M&eacute;todo de Sundaresan e Krishnaswami</h2>
<pre class="codeinput">t1 = 9.15;
t2 = 24.1;

tau_g = 0.67 * (t2 - t1);
theta_g = 1.3 * t1 - 0.29 * t2;

Hs_g = (k*exp(- theta_g * s)) / (tau_g*s + 1);
y_g = (2*step(Hs_g, tempo)) + 2;

fprintf(<span class="string">"K = %.2f &deg;C/V \n"</span>, k);
fprintf(<span class="string">"theta = %f segundos \n"</span>, theta_g);
fprintf(<span class="string">"tau = %f segundos \n"</span>, tau_g);

figure();
hold(<span class="string">"on"</span>);
plot(tempo, saida);
plot(tempo, y_g);
title(<span class="string">"Resposta do sistema - M&eacute;todo de Sundaresan"</span>);
xlabel(<span class="string">"Tempo(s)"</span>);
ylabel(<span class="string">"Temperatura (&deg;C)"</span>);
grid(<span class="string">"on"</span>);

erro_g = 0;
<span class="keyword">for</span> i = 1: 1: 1000

    erro_g = erro_g + (saida(i) - y_g(i))^2;

<span class="keyword">end</span>

erro_g = erro_g/1000;
</pre>
<pre class="codeoutput">K = 3.00 &deg;C/V 
theta = 4.906000 segundos 
tau = 10.016500 segundos 
</pre>
<img vspace="5" hspace="5" src="pratica9_09.png" alt=""> <h2 id="11">Ex01 - M&eacute;todo da inclina&ccedil;&atilde;o inicial;</h2>
<pre class="codeinput">ya = 2;
yb = 4.75;
xa = 5;
xb = 10;

m = (yb - ya) / (xb - xa);

theta_h = 5;
tau_h = 1/m + theta_h;

Hs_h = (k*exp(- theta_h * s)) / (tau_h*s + 1);
y_h = (2*step(Hs_h, tempo)) + 2;

fprintf(<span class="string">"K = %.2f &deg;C/V \n"</span>, k);
fprintf(<span class="string">"theta = %f segundos \n"</span>, theta_h);
fprintf(<span class="string">"tau = %f segundos \n"</span>, tau_h);

figure();
hold(<span class="string">"on"</span>);
plot(tempo, saida);
plot(tempo, y_h);
title(<span class="string">"Resposta do sistema - M&eacute;todo da inclina&ccedil;&atilde;o inicial"</span>);
xlabel(<span class="string">"Tempo(s)"</span>);
ylabel(<span class="string">"Temperatura (&deg;C)"</span>);
grid(<span class="string">"on"</span>);

erro_h = 0;
<span class="keyword">for</span> i = 1: 1: 1000

    erro_h = erro_h + (saida(i) - y_h(i))^2;

<span class="keyword">end</span>

erro_h = erro_h/1000;
</pre>
<pre class="codeoutput">K = 3.00 &deg;C/V 
theta = 5.000000 segundos 
tau = 6.818182 segundos 
</pre>
<img vspace="5" hspace="5" src="pratica9_10.png" alt=""> <h2 id="12">Ex01 - Compara&ccedil;&atilde;o dos erros m&eacute;dios quadraticos</h2>
<pre class="codeinput">fprintf(<span class="string">"Erro m&eacute;todo da instegrais:            %f \n"</span>, erro_a);
fprintf(<span class="string">"Erro m&eacute;todo de 1 constante de tempo:  %f \n"</span>, erro_b);
fprintf(<span class="string">"Erro m&eacute;todo de 4 constantes de tempo: %f \n"</span>, erro_c);
fprintf(<span class="string">"Erro m&eacute;todo de Ziegler-Nichols:       %f \n"</span>, erro_d);
fprintf(<span class="string">"Erro m&eacute;todo de Smith:                 %f \n"</span>, erro_e);
fprintf(<span class="string">"Erro m&eacute;todo de Haglund:               %f \n"</span>, erro_f);
fprintf(<span class="string">"Erro m&eacute;todo de Sundaresan:            %f \n"</span>, erro_g);
fprintf(<span class="string">"Erro m&eacute;todo da inclina&ccedil;&atilde;o inicial:    %f \n \n"</span>, erro_h);

fprintf(<span class="string">"Conforme pode ser observado pela compara&ccedil;&atilde;o dos erros m&eacute;dios quadraticos \n"</span> + <span class="keyword">...</span>
        <span class="string">"os metodos que apresentaram resultasdos mais satisfat&oacute;rios foram respectivamente: \n"</span> + <span class="keyword">...</span>
         <span class="string">"M&eacute;todo de uma constante de tempo e Sundaresan"</span>, erro_h);
</pre>
<pre class="codeoutput">Erro m&eacute;todo da instegrais:            0.091889 
Erro m&eacute;todo de 1 constante de tempo:  0.038529 
Erro m&eacute;todo de 4 constantes de tempo: 0.452999 
Erro m&eacute;todo de Ziegler-Nichols:       0.076013 
Erro m&eacute;todo de Smith:                 0.182573 
Erro m&eacute;todo de Haglund:               0.082306 
Erro m&eacute;todo de Sundaresan:            0.039057 
Erro m&eacute;todo da inclina&ccedil;&atilde;o inicial:    0.255838 
 
Conforme pode ser observado pela compara&ccedil;&atilde;o dos erros m&eacute;dios quadraticos 
os metodos que apresentaram resultasdos mais satisfat&oacute;rios foram respectivamente: 
M&eacute;todo de uma constante de tempo e Sundaresan</pre>
<p class="footer">
<br>
<a href="https://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2024a</a>
<br>
</p>
</div>
<!--
##### SOURCE BEGIN #####
%% Laboratório de Sistemas Dinâicos
% Prática 08
% 29/07/2024
% Autores: Victor Hugo Daia Lorenzato e Whilker Henrique Santos Silva

%% Limpar workspace
close all;
clear;
clc;

%% Ex01 - importação dados

data = load('dadosordem1.txt');

tempo = data(:,1);
entrada = data(:,2);
saida = data(:,3);

plot(tempo, entrada);
title("Entrada do sistema");
xlabel("Tempo(s)");
ylabel("Tensão (Volts)");


figure();
plot(tempo, saida);
title("Saída do sistema");
xlabel("Tempo(s)");
ylabel("Temperatura (°C)");
grid("on");



%%  Ex01 - Cálculo do Ganho

du = entrada(end) - 0;
dy = 8 - 2;

k = dy/du;

fprintf("Ganho dc do sistema é igual a %.2f °C/V \n", k);

%% Ex01 - Método da integrais

entrada_normalizada = entrada / 2;
saida_normalizada = (saida - 2) / 6;

Iu = cumtrapz(tempo, entrada_normalizada);
Iy = cumtrapz(tempo, saida_normalizada);

A1 = Iu(end) - Iy(end);

i = 1;
while(saida_normalizada(i) < 0.632)
    i = i + 1;
end

tau_a= Iy(i) * exp(1);
theta_a = A1 - tau_a;

fprintf("K = %.2f °C/V \n", k);
fprintf("theta = %f segundos \n", theta_a);
fprintf("tau = %f segundos \n", tau_a);

s = tf('s');
Hs_a = (k*exp(- theta_a * s)) / (tau_a*s + 1);
y_a = (2*step(Hs_a, tempo)) + 2;

figure();
hold("on");
plot(tempo, saida);
plot(tempo, y_a);
title("Resposta do sistema - Método da integrais");
xlabel("Tempo(s)");
ylabel("Temperatura (°C)");
grid("on");

erro_a = 0;
for i = 1: 1: 1000

    erro_a = erro_a + (saida(i) - y_a(i))^2;
    
end

erro_a = erro_a/1000;

%% Ex01 - Método de 1 constante de tempo

theta_b = 5;
tau_b = 15 - theta_b;


Hs_b = (k*exp(- theta_b * s)) / (tau_b*s + 1);
y_b = (2*step(Hs_b, tempo)) + 2;

fprintf("K = %.2f °C/V \n", k);
fprintf("theta = %f segundos \n", theta_b);
fprintf("tau = %f segundos \n", tau_b);

figure();
hold("on");
plot(tempo, saida);
plot(tempo, y_b);
title("Resposta do sistema - Método de 1 constante de tempo");
xlabel("Tempo(s)");
ylabel("Temperatura (°C)");
grid("on");

erro_b = 0;
for i = 1: 1: 1000

    erro_b = erro_b + (saida(i) - y_b(i))^2;
    
end

erro_b = erro_b/1000;

%% Ex01 - Método de 4 constantes de tempo

theta_c = 5;
tau_c = 43/4 - theta_c;


Hs_c = (k*exp(- theta_c * s)) / (tau_c*s + 1);
y_c = (2*step(Hs_c, tempo)) + 2;

fprintf("K = %.2f °C/V \n", k);
fprintf("theta = %f segundos \n", theta_c);
fprintf("tau = %f segundos \n", tau_c);

figure();
hold("on");
plot(tempo, saida);
plot(tempo, y_c);
title("Resposta do sistema - Método de 4 constantes de tempo");
xlabel("Tempo(s)");
ylabel("Temperatura (°C)");
grid("on");

erro_c = 0;
for i = 1: 1: 1000

    erro_c = erro_c + (saida(i) - y_c(i))^2;
    
end

erro_c = erro_c/1000;

%% Ex01 - Método de Ziegler-Nichols

theta_d = 5;
tau_d = 16.5 - theta_d;

Hs_d = (k*exp(- theta_d * s)) / (tau_d*s + 1);
y_d = (2*step(Hs_d, tempo)) + 2;

fprintf("K = %.2f °C/V \n", k);
fprintf("theta = %f segundos \n", theta_d);
fprintf("tau = %f segundos \n", tau_d);

figure();
hold("on");
plot(tempo, saida);
plot(tempo, y_d);
title("Resposta do sistema - Método de Ziegler-Nichols");
xlabel("Tempo(s)");
ylabel("Temperatura (°C)");
grid("on");

erro_d = 0;
for i = 1: 1: 1000

    erro_d = erro_d + (saida(i) - y_d(i))^2;
    
end

erro_d = erro_d/1000;
%% Ex01 - Método de Smith

t1 = 6.15;
t2 = 15;

tau_e = 1.5 * (t2-t1);
theta_e = t2 - tau_e;

Hs_e = (k*exp(- theta_e * s)) / (tau_e*s + 1);
y_e = (2*step(Hs_e, tempo)) + 2;

fprintf("K = %.2f °C/V \n", k);
fprintf("theta = %f segundos \n", theta_e);
fprintf("tau = %f segundos \n", tau_e);

figure();
hold("on");
plot(tempo, saida);
plot(tempo, y_e);
title("Resposta do sistema - Método de Smith");
xlabel("Tempo(s)");
ylabel("Temperatura (°C)");
grid("on");

erro_e = 0;
for i = 1: 1: 1000

    erro_e = erro_e + (saida(i) - y_e(i))^2;
    
end

erro_e = erro_e/1000;

%% Ex01 - Método de Haglund

theta_f = 5;
tau_f = 13.5 - theta_f;

Hs_f = (k*exp(- theta_f * s)) / (tau_f*s + 1);
y_f = (2*step(Hs_f, tempo)) + 2;

fprintf("K = %.2f °C/V \n", k);
fprintf("theta = %f segundos \n", theta_f);
fprintf("tau = %f segundos \n", tau_f);

figure();
hold("on");
plot(tempo, saida);
plot(tempo, y_f);
title("Resposta do sistema - Método de Haglund");
xlabel("Tempo(s)");
ylabel("Temperatura (°C)");
grid("on");

erro_f = 0;
for i = 1: 1: 1000

    erro_f = erro_f + (saida(i) - y_f(i))^2;
    
end

erro_f = erro_f/1000;

%% Ex01 - Método de Sundaresan e Krishnaswami


t1 = 9.15;
t2 = 24.1;

tau_g = 0.67 * (t2 - t1);
theta_g = 1.3 * t1 - 0.29 * t2;

Hs_g = (k*exp(- theta_g * s)) / (tau_g*s + 1);
y_g = (2*step(Hs_g, tempo)) + 2;

fprintf("K = %.2f °C/V \n", k);
fprintf("theta = %f segundos \n", theta_g);
fprintf("tau = %f segundos \n", tau_g);

figure();
hold("on");
plot(tempo, saida);
plot(tempo, y_g);
title("Resposta do sistema - Método de Sundaresan");
xlabel("Tempo(s)");
ylabel("Temperatura (°C)");
grid("on");

erro_g = 0;
for i = 1: 1: 1000

    erro_g = erro_g + (saida(i) - y_g(i))^2;
    
end

erro_g = erro_g/1000;


%% Ex01 - Método da inclinação inicial;

ya = 2;
yb = 4.75;
xa = 5;
xb = 10;

m = (yb - ya) / (xb - xa);

theta_h = 5;
tau_h = 1/m + theta_h;

Hs_h = (k*exp(- theta_h * s)) / (tau_h*s + 1);
y_h = (2*step(Hs_h, tempo)) + 2;

fprintf("K = %.2f °C/V \n", k);
fprintf("theta = %f segundos \n", theta_h);
fprintf("tau = %f segundos \n", tau_h);

figure();
hold("on");
plot(tempo, saida);
plot(tempo, y_h);
title("Resposta do sistema - Método da inclinação inicial");
xlabel("Tempo(s)");
ylabel("Temperatura (°C)");
grid("on");

erro_h = 0;
for i = 1: 1: 1000

    erro_h = erro_h + (saida(i) - y_h(i))^2;
    
end

erro_h = erro_h/1000;


%% Ex01 - Comparação dos erros médios quadraticos

fprintf("Erro método da instegrais:            %f \n", erro_a);
fprintf("Erro método de 1 constante de tempo:  %f \n", erro_b);
fprintf("Erro método de 4 constantes de tempo: %f \n", erro_c);
fprintf("Erro método de Ziegler-Nichols:       %f \n", erro_d);
fprintf("Erro método de Smith:                 %f \n", erro_e);
fprintf("Erro método de Haglund:               %f \n", erro_f);
fprintf("Erro método de Sundaresan:            %f \n", erro_g);
fprintf("Erro método da inclinação inicial:    %f \n \n", erro_h);

fprintf("Conforme pode ser observado pela comparação dos erros médios quadraticos \n" + ...
        "os metodos que apresentaram resultasdos mais satisfatórios foram respectivamente: \n" + ...
         "Método de uma constante de tempo e Sundaresan", erro_h);

##### SOURCE END #####
-->
</body>
</html>
